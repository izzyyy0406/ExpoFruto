const translations = {
  es: {
    // Navigation
    "nav.inicio": "Inicio",
    "nav.nosotros": "Nosotros",
    "nav.productos": "Productos",
    "nav.procesos": "Procesos",
    "nav.contacto": "Contacto",
    "nav.precios": "Precios de la semana",

    // Hero section
    "procesos.heroTitle": "Nuestros Procesos de Exportación",
    "procesos.heroSubtitle":
      "Calidad garantizada desde el campo hasta su destino final",

    // Process section
    "procesos.tituloSeccion": "Cómo Exportamos Nuestras Frutas",
    "procesos.descSeccion":
      "Cada paso de nuestro proceso está diseñado para garantizar la máxima calidad y frescura",

    // Process steps
    "procesos.paso1.titulo": "Selección en Campo",
    "procesos.paso1.desc":
      "Nuestros expertos seleccionan las frutas en su punto óptimo de maduración directamente desde los cultivos asociados.",
    "procesos.paso2.titulo": "Transporte Refrigerado",
    "procesos.paso2.desc":
      "Las frutas son transportadas en vehículos con temperatura controlada hasta nuestra planta de procesamiento.",
    "procesos.paso3.titulo": "Lavado y Desinfección",
    "procesos.paso3.desc":
      "Proceso riguroso de limpieza con agua potable y desinfección con productos autorizados para consumo humano.",
    "procesos.paso4.titulo": "Clasificación por Calidad",
    "procesos.paso4.desc":
      "Sistemas automatizados y personal especializado clasifican las frutas por tamaño, color y calidad.",
    "procesos.paso5.titulo": "Empaque Especializado",
    "procesos.paso5.desc":
      "Utilizamos empaques diseñados para proteger las frutas durante el transporte internacional.",
    "procesos.paso6.titulo": "Almacenamiento en Frío",
    "procesos.paso6.desc":
      "Las frutas se almacenan en cámaras frigoríficas hasta su despacho, manteniendo la cadena de frío.",
    "procesos.paso7.titulo": "Transporte Internacional",
    "procesos.paso7.desc":
      "Enviamos las frutas por vía aérea o marítima en contenedores refrigerados, según el destino.",
    "procesos.paso8.titulo": "Distribución Final",
    "procesos.paso8.desc":
      "Coordinamos con distribuidores locales para entregar el producto fresco a los puntos de venta.",

    // Gallery
    "galeriaFotos.titulo": "Nuestro Proceso en Imágenes",
    "galeriaFotos.img1.alt": "Cultivo",
    "galeriaFotos.img1.desc": "Selección en campo",
    "galeriaFotos.img2.alt": "Transporte",
    "galeriaFotos.img2.desc": "Transporte",
    "galeriaFotos.img3.alt": "Lavado",
    "galeriaFotos.img3.desc": "Lavado y desinfección",
    "galeriaFotos.img4.alt": "Clasificación",
    "galeriaFotos.img4.desc": "Clasificación por calidad",
    "galeriaFotos.img5.alt": "Empaque",
    "galeriaFotos.img5.desc": "Empaque especializado",
    "galeriaFotos.img6.alt": "Almacenamiento",
    "galeriaFotos.img6.desc": "Almacenamiento en frío",
    "galeriaFotos.img7.alt": "Exportación",
    "galeriaFotos.img7.desc": "Preparación para exportación",

    // Video gallery
    "galeriaVideos.titulo": "Conoce Nuestro Trabajo",
    "galeriaVideos.vid1.desc": "Proceso de selección en campo",
    "galeriaVideos.vid2.desc": "Lavado y desinfección de frutas",
    "galeriaVideos.vid3.desc": "Clasificación automatizada por calidad",
    "galeriaVideos.vid4.desc": "Empaque para exportación",

    // Fruit care
    "cuidados.titulo": "Cuidados Especializados",
    "cuidados.subtitulo":
      "Cada fruta requiere un manejo especial para mantener su calidad durante el transporte",
    "cuidados.aguacate.titulo": "Aguacate Hass",
    "cuidados.aguacate.item1": "Temperatura óptima: 4-8°C",
    "cuidados.aguacate.item2": "Humedad relativa: 85-95%",
    "cuidados.aguacate.item3": "Evitar contacto con etileno",
    "cuidados.aguacate.item4": "Empaque individual con protección",
    "cuidados.aguacate.item5": "Vida útil postcosecha: 2-4 semanas",
    "cuidados.limon.titulo": "Limón Tahití",
    "cuidados.limon.item1": "Temperatura óptima: 8-10°C",
    "cuidados.limon.item2": "Humedad relativa: 90-95%",
    "cuidados.limon.item3": "Resistente a bajas temperaturas",
    "cuidados.limon.item4": "Empaque en mallas ventiladas",
    "cuidados.limon.item5": "Vida útil postcosecha: 3-6 semanas",
    "cuidados.boton": "Ver todos nuestros productos",

    // CTA
    "ctaTrabaja.titulo": "¿Quieres trabajar con nosotros?",
    "ctaTrabaja.desc":
      "Únete a nuestra red de productores y comercializadores internacionales",
    "ctaTrabaja.boton1": "Soy comerciante",
    "ctaTrabaja.boton2": "Soy productor",

    // Footer
    footer_description: "Exportamos calidad desde Colombia para el mundo.",
    footer_contact: "Contacto",
    footer_links: "Enlaces Rápidos",
    nav_about: "Nosotros",
    nav_products: "Productos",
    nav_prices: "Precio Semanal",
    nav_processes: "Procesos",
    nav_contact: "Contacto",
    footer_rights: "Todos los derechos reservados.",
    footer_privacy: "Política de Privacidad",
    footer_terms: "Términos y Condiciones",
  },
  en: {
    // Navigation
    "nav.inicio": "Home",
    "nav.nosotros": "About Us",
    "nav.productos": "Products",
    "nav.procesos": "Processes",
    "nav.contacto": "Contact",
    "nav.precios": "Weekly Prices",

    // Hero section
    "procesos.heroTitle": "Our Export Processes",
    "procesos.heroSubtitle":
      "Guaranteed quality from the field to its final destination",

    // Process section
    "procesos.tituloSeccion": "How We Export Our Fruits",
    "procesos.descSeccion":
      "Each step of our process is designed to ensure maximum quality and freshness",

    // Process steps
    "procesos.paso1.titulo": "Field Selection",
    "procesos.paso1.desc":
      "Our experts select fruits at their optimal ripening point directly from associated crops.",
    "procesos.paso2.titulo": "Refrigerated Transport",
    "procesos.paso2.desc":
      "Fruits are transported in temperature-controlled vehicles to our processing plant.",
    "procesos.paso3.titulo": "Washing and Disinfection",
    "procesos.paso3.desc":
      "Rigorous cleaning process with potable water and disinfection with authorized products for human consumption.",
    "procesos.paso4.titulo": "Quality Classification",
    "procesos.paso4.desc":
      "Automated systems and specialized staff classify fruits by size, color and quality.",
    "procesos.paso5.titulo": "Specialized Packaging",
    "procesos.paso5.desc":
      "We use packaging designed to protect fruits during international transport.",
    "procesos.paso6.titulo": "Cold Storage",
    "procesos.paso6.desc":
      "Fruits are stored in refrigerated chambers until dispatch, maintaining the cold chain.",
    "procesos.paso7.titulo": "International Transport",
    "procesos.paso7.desc":
      "We ship fruits by air or sea in refrigerated containers, depending on the destination.",
    "procesos.paso8.titulo": "Final Distribution",
    "procesos.paso8.desc":
      "We coordinate with local distributors to deliver fresh product to retail outlets.",

    // Gallery
    "galeriaFotos.titulo": "Our Process in Pictures",
    "galeriaFotos.img1.alt": "Cultivation",
    "galeriaFotos.img1.desc": "Field selection",
    "galeriaFotos.img2.alt": "Transport",
    "galeriaFotos.img2.desc": "Transport",
    "galeriaFotos.img3.alt": "Washing",
    "galeriaFotos.img3.desc": "Washing and disinfection",
    "galeriaFotos.img4.alt": "Classification",
    "galeriaFotos.img4.desc": "Quality classification",
    "galeriaFotos.img5.alt": "Packaging",
    "galeriaFotos.img5.desc": "Specialized packaging",
    "galeriaFotos.img6.alt": "Storage",
    "galeriaFotos.img6.desc": "Cold storage",
    "galeriaFotos.img7.alt": "Export",
    "galeriaFotos.img7.desc": "Export preparation",

    // Video gallery
    "galeriaVideos.titulo": "Discover Our Work",
    "galeriaVideos.vid1.desc": "Field selection process",
    "galeriaVideos.vid2.desc": "Fruit washing and disinfection",
    "galeriaVideos.vid3.desc": "Automated quality classification",
    "galeriaVideos.vid4.desc": "Export packaging",

    // Fruit care
    "cuidados.titulo": "Specialized Care",
    "cuidados.subtitulo":
      "Each fruit requires special handling to maintain its quality during transport",
    "cuidados.aguacate.titulo": "Hass Avocado",
    "cuidados.aguacate.item1": "Optimal temperature: 4-8°C",
    "cuidados.aguacate.item2": "Relative humidity: 85-95%",
    "cuidados.aguacate.item3": "Avoid contact with ethylene",
    "cuidados.aguacate.item4": "Individual protective packaging",
    "cuidados.aguacate.item5": "Post-harvest shelf life: 2-4 weeks",
    "cuidados.limon.titulo": "Tahiti Lime",
    "cuidados.limon.item1": "Optimal temperature: 8-10°C",
    "cuidados.limon.item2": "Relative humidity: 90-95%",
    "cuidados.limon.item3": "Resistant to low temperatures",
    "cuidados.limon.item4": "Packaging in ventilated mesh",
    "cuidados.limon.item5": "Post-harvest shelf life: 3-6 weeks",
    "cuidados.boton": "View all our products",

    // CTA
    "ctaTrabaja.titulo": "Want to work with us?",
    "ctaTrabaja.desc":
      "Join our network of international producers and marketers",
    "ctaTrabaja.boton1": "I'm a merchant",
    "ctaTrabaja.boton2": "I'm a producer",

    // Footer
    footer_description: "We export quality from Colombia to the world.",
    footer_contact: "Contact",
    footer_links: "Quick Links",
    nav_about: "About Us",
    nav_products: "Products",
    nav_prices: "Weekly Prices",
    nav_processes: "Processes",
    nav_contact: "Contact",
    footer_rights: "All rights reserved.",
    footer_privacy: "Privacy Policy",
    footer_terms: "Terms and Conditions",
  },
  fr: {
    // Navigation
    "nav.inicio": "Accueil",
    "nav.nosotros": "À propos",
    "nav.productos": "Produits",
    "nav.procesos": "Processus",
    "nav.contacto": "Contact",
    "nav.precios": "Prix hebdomadaires",

    // Hero section
    "procesos.heroTitle": "Nos Processus d'Exportation",
    "procesos.heroSubtitle":
      "Qualité garantie du champ à sa destination finale",

    // Process section
    "procesos.tituloSeccion": "Comment Nous Exportons Nos Fruits",
    "procesos.descSeccion":
      "Chaque étape de notre processus est conçue pour garantir une qualité et une fraîcheur maximales",

    // Process steps
    "procesos.paso1.titulo": "Sélection au Champ",
    "procesos.paso1.desc":
      "Nos experts sélectionnent les fruits à leur point optimal de maturation directement dans les cultures associées.",
    "procesos.paso2.titulo": "Transport Réfrigéré",
    "procesos.paso2.desc":
      "Les fruits sont transportés dans des véhicules à température contrôlée jusqu'à notre usine de transformation.",
    "procesos.paso3.titulo": "Lavage et Désinfection",
    "procesos.paso3.desc":
      "Processus rigoureux de nettoyage avec de l'eau potable et désinfection avec des produits autorisés pour la consommation humaine.",
    "procesos.paso4.titulo": "Classification par Qualité",
    "procesos.paso4.desc":
      "Des systèmes automatisés et du personnel spécialisé classent les fruits par taille, couleur et qualité.",
    "procesos.paso5.titulo": "Emballage Spécialisé",
    "procesos.paso5.desc":
      "Nous utilisons des emballages conçus pour protéger les fruits pendant le transport international.",
    "procesos.paso6.titulo": "Stockage à Froid",
    "procesos.paso6.desc":
      "Les fruits sont stockés dans des chambres froides jusqu'à leur expédition, en maintenant la chaîne du froid.",
    "procesos.paso7.titulo": "Transport International",
    "procesos.paso7.desc":
      "Nous expédions les fruits par voie aérienne ou maritime dans des conteneurs réfrigérés, selon la destination.",
    "procesos.paso8.titulo": "Distribution Finale",
    "procesos.paso8.desc":
      "Nous coordonnons avec les distributeurs locaux pour livrer le produit frais aux points de vente.",

    // Gallery
    "galeriaFotos.titulo": "Notre Processus en Images",
    "galeriaFotos.img1.alt": "Culture",
    "galeriaFotos.img1.desc": "Sélection au champ",
    "galeriaFotos.img2.alt": "Transport",
    "galeriaFotos.img2.desc": "Transport",
    "galeriaFotos.img3.alt": "Lavage",
    "galeriaFotos.img3.desc": "Lavage et désinfection",
    "galeriaFotos.img4.alt": "Classification",
    "galeriaFotos.img4.desc": "Classification par qualité",
    "galeriaFotos.img5.alt": "Emballage",
    "galeriaFotos.img5.desc": "Emballage spécialisé",
    "galeriaFotos.img6.alt": "Stockage",
    "galeriaFotos.img6.desc": "Stockage à froid",
    "galeriaFotos.img7.alt": "Exportation",
    "galeriaFotos.img7.desc": "Préparation à l'exportation",

    // Video gallery
    "galeriaVideos.titulo": "Découvrez Notre Travail",
    "galeriaVideos.vid1.desc": "Processus de sélection au champ",
    "galeriaVideos.vid2.desc": "Lavage et désinfection des fruits",
    "galeriaVideos.vid3.desc": "Classification automatisée par qualité",
    "galeriaVideos.vid4.desc": "Emballage pour exportation",

    // Fruit care
    "cuidados.titulo": "Soins Spécialisés",
    "cuidados.subtitulo":
      "Chaque fruit nécessite une manipulation spéciale pour maintenir sa qualité pendant le transport",
    "cuidados.aguacate.titulo": "Avocat Hass",
    "cuidados.aguacate.item1": "Température optimale : 4-8°C",
    "cuidados.aguacate.item2": "Humidité relative : 85-95%",
    "cuidados.aguacate.item3": "Éviter le contact avec l'éthylène",
    "cuidados.aguacate.item4": "Emballage individuel avec protection",
    "cuidados.aguacate.item5": "Durée de vie post-récolte : 2-4 semaines",
    "cuidados.limon.titulo": "Citron Tahiti",
    "cuidados.limon.item1": "Température optimale : 8-10°C",
    "cuidados.limon.item2": "Humidité relative : 90-95%",
    "cuidados.limon.item3": "Résistant aux basses températures",
    "cuidados.limon.item4": "Emballage en filets ventilés",
    "cuidados.limon.item5": "Durée de vie post-récolte : 3-6 semaines",
    "cuidados.boton": "Voir tous nos produits",

    // CTA
    "ctaTrabaja.titulo": "Vous voulez travailler avec nous ?",
    "ctaTrabaja.desc":
      "Rejoignez notre réseau de producteurs et distributeurs internationaux",
    "ctaTrabaja.boton1": "Je suis commerçant",
    "ctaTrabaja.boton2": "Je suis producteur",

    // Footer
    footer_description:
      "Nous exportons la qualité de la Colombie vers le monde.",
    footer_contact: "Contact",
    footer_links: "Liens Rapides",
    nav_about: "À propos",
    nav_products: "Produits",
    nav_prices: "Prix Hebdomadaires",
    nav_processes: "Processus",
    nav_contact: "Contact",
    footer_rights: "Tous droits réservés.",
    footer_privacy: "Politique de Confidentialité",
    footer_terms: "Conditions Générales",
  },
  it: {
    // Navigation
    "nav.inicio": "Home",
    "nav.nosotros": "Chi Siamo",
    "nav.productos": "Prodotti",
    "nav.procesos": "Processi",
    "nav.contacto": "Contatto",
    "nav.precios": "Prezzi Settimanali",

    // Hero section
    "procesos.heroTitle": "I Nostri Processi di Esportazione",
    "procesos.heroSubtitle":
      "Qualità garantita dal campo alla destinazione finale",

    // Process section
    "procesos.tituloSeccion": "Come Esportiamo la Nostra Frutta",
    "procesos.descSeccion":
      "Ogni passo del nostro processo è progettato per garantire la massima qualità e freschezza",

    // Process steps
    "procesos.paso1.titulo": "Selezione in Campo",
    "procesos.paso1.desc":
      "I nostri esperti selezionano i frutti al loro punto ottimale di maturazione direttamente dalle coltivazioni associate.",
    "procesos.paso2.titulo": "Trasporto Refrigerato",
    "procesos.paso2.desc":
      "I frutti vengono trasportati in veicoli a temperatura controllata fino al nostro impianto di lavorazione.",
    "procesos.paso3.titulo": "Lavaggio e Disinfezione",
    "procesos.paso3.desc":
      "Processo rigoroso di pulizia con acqua potabile e disinfezione con prodotti autorizzati per il consumo umano.",
    "procesos.paso4.titulo": "Classificazione per Qualità",
    "procesos.paso4.desc":
      "Sistemi automatizzati e personale specializzato classificano i frutti per dimensione, colore e qualità.",
    "procesos.paso5.titulo": "Imballaggio Specializzato",
    "procesos.paso5.desc":
      "Utilizziamo imballaggi progettati per proteggere i frutti durante il trasporto internazionale.",
    "procesos.paso6.titulo": "Magazzinaggio a Freddo",
    "procesos.paso6.desc":
      "I frutti vengono conservati in celle frigorifere fino alla spedizione, mantenendo la catena del freddo.",
    "procesos.paso7.titulo": "Trasporto Internazionale",
    "procesos.paso7.desc":
      "Spediamo i frutti via aerea o marittima in container refrigerati, a seconda della destinazione.",
    "procesos.paso8.titulo": "Distribuzione Finale",
    "procesos.paso8.desc":
      "Coordiniamo con distributori locali per consegnare il prodotto fresco ai punti vendita.",

    // Gallery
    "galeriaFotos.titulo": "Il Nostro Processo in Immagini",
    "galeriaFotos.img1.alt": "Coltivazione",
    "galeriaFotos.img1.desc": "Selezione in campo",
    "galeriaFotos.img2.alt": "Trasporto",
    "galeriaFotos.img2.desc": "Trasporto",
    "galeriaFotos.img3.alt": "Lavaggio",
    "galeriaFotos.img3.desc": "Lavaggio e disinfezione",
    "galeriaFotos.img4.alt": "Classificazione",
    "galeriaFotos.img4.desc": "Classificazione per qualità",
    "galeriaFotos.img5.alt": "Imballaggio",
    "galeriaFotos.img5.desc": "Imballaggio specializzato",
    "galeriaFotos.img6.alt": "Magazzinaggio",
    "galeriaFotos.img6.desc": "Magazzinaggio a freddo",
    "galeriaFotos.img7.alt": "Esportazione",
    "galeriaFotos.img7.desc": "Preparazione per l'esportazione",

    // Video gallery
    "galeriaVideos.titulo": "Scopri il Nostro Lavoro",
    "galeriaVideos.vid1.desc": "Processo di selezione in campo",
    "galeriaVideos.vid2.desc": "Lavaggio e disinfezione della frutta",
    "galeriaVideos.vid3.desc": "Classificazione automatizzata per qualità",
    "galeriaVideos.vid4.desc": "Imballaggio per esportazione",

    // Fruit care
    "cuidados.titulo": "Cure Specializzate",
    "cuidados.subtitulo":
      "Ogni frutto richiede una manipolazione speciale per mantenere la sua qualità durante il trasporto",
    "cuidados.aguacate.titulo": "Avocado Hass",
    "cuidados.aguacate.item1": "Temperatura ottimale: 4-8°C",
    "cuidados.aguacate.item2": "Umidità relativa: 85-95%",
    "cuidados.aguacate.item3": "Evitare il contatto con l'etilene",
    "cuidados.aguacate.item4": "Imballaggio individuale con protezione",
    "cuidados.aguacate.item5": "Vita utile post-raccolta: 2-4 settimane",
    "cuidados.limon.titulo": "Lime Tahiti",
    "cuidados.limon.item1": "Temperatura ottimale: 8-10°C",
    "cuidados.limon.item2": "Umidità relativa: 90-95%",
    "cuidados.limon.item3": "Resistente alle basse temperature",
    "cuidados.limon.item4": "Imballaggio in reti ventilate",
    "cuidados.limon.item5": "Vita utile post-raccolta: 3-6 settimane",
    "cuidados.boton": "Vedi tutti i nostri prodotti",

    // CTA
    "ctaTrabaja.titulo": "Vuoi lavorare con noi?",
    "ctaTrabaja.desc":
      "Unisciti alla nostra rete di produttori e distributori internazionali",
    "ctaTrabaja.boton1": "Sono un commerciante",
    "ctaTrabaja.boton2": "Sono un produttore",

    // Footer
    footer_description: "Esportiamo qualità dalla Colombia al mondo.",
    footer_contact: "Contatto",
    footer_links: "Link Veloci",
    nav_about: "Chi Siamo",
    nav_products: "Prodotti",
    nav_prices: "Prezzi Settimanali",
    nav_processes: "Processi",
    nav_contact: "Contatto",
    footer_rights: "Tutti i diritti riservati.",
    footer_privacy: "Privacy Policy",
    footer_terms: "Termini e Condizioni",
  },
};

// Objeto con banderas por idioma (mejor mantenerlo junto a la función que lo usa)
const LANGUAGE_FLAGS = {
  es: "colombia.png",
  en: "euu.png",
  fr: "francia.png",
  it: "italia.webp",
};

// Función para cambiar el idioma (versión mejorada)
function changeLanguage(lang) {
  try {
    // 1. Validar que el idioma existe en las traducciones
    if (!translations[lang]) {
      console.error(`Idioma no soportado: ${lang}`);
      lang = "es"; // Default fallback
    }

    // 2. Actualizar atributo lang del HTML
    document.documentElement.lang = lang;

    // 3. Traducir todos los elementos con data-i18n (incluyendo placeholders, alt texts, etc.)
    document.querySelectorAll("[data-i18n]").forEach((element) => {
      const key = element.getAttribute("data-i18n");

      if (translations[lang][key]) {
        // Manejar diferentes tipos de elementos
        if (element.tagName === "INPUT" || element.tagName === "TEXTAREA") {
          element.placeholder = translations[lang][key];
        } else if (element.tagName === "IMG") {
          element.alt = translations[lang][key];
        } else {
          element.textContent = translations[lang][key];
        }
      } else {
        console.warn(`Falta traducción para clave: ${key} en idioma ${lang}`);
      }
    });

    // 4. Actualizar botón de idioma (con verificación más robusta)
    const langButton = document.querySelector(".language-dropdown");
    if (langButton) {
      const flagImage = LANGUAGE_FLAGS[lang] || LANGUAGE_FLAGS.es;
      langButton.innerHTML = `
        <img src="img/${flagImage}" 
             alt="${lang}" 
             class="flag-icon"> 
        ${lang.toUpperCase()}
      `;
    }

    // 5. Guardar preferencia con verificación de localStorage
    try {
      localStorage.setItem("preferredLanguage", lang);
    } catch (e) {
      console.error("Error al guardar en localStorage:", e);
    }
  } catch (error) {
    console.error("Error en changeLanguage:", error);
  }
}

// Función optimizada para obtener bandera
function getFlagImage(lang) {
  return LANGUAGE_FLAGS[lang] || LANGUAGE_FLAGS.es;
}

// Inicialización mejorada
function initLanguage() {
  // 1. Configurar eventos de botones de idioma
  document.querySelectorAll("[data-lang]").forEach((button) => {
    button.addEventListener("click", function (e) {
      e.preventDefault();
      changeLanguage(this.getAttribute("data-lang"));
    });
  });

  // 2. Cargar idioma preferido con validación
  let savedLang = localStorage.getItem("preferredLanguage");
  if (!savedLang || !translations[savedLang]) {
    savedLang = "es"; // Idioma por defecto
  }

  // 3. Aplicar idioma inicial
  changeLanguage(savedLang);
}

// Esperar a que el DOM esté completamente cargado
document.addEventListener("DOMContentLoaded", initLanguage);

// Opcional: Manejar cambios dinámicos de contenido
document.addEventListener("contentLoaded", initLanguage);
